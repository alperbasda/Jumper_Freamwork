

//---------------------------------------------------------------------------------------
//      This code was generated by a Jumper tool. 
//      Runtime version : 1.0
//      Generation Time : 23.10.2023 11:28
//---------------------------------------------------------------------------------------

using Core.ApiHelpers.JwtHelper.Models;
using Core.CrossCuttingConcerns.Serilog.Logger;
using Core.CrossCuttingConcerns.Serilog;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using IdentityServer.Common.IdentityConfigurations;
using IdentityServer.Application.Helpers;

namespace IdentityServer.UI.Api.Middlewares;

public static class AddApiRegistrationServices
{
    public static IServiceCollection AddApiServices(this IServiceCollection services, IConfiguration configuration)
    {
        services.AddScoped<TokenParameters>();
        services.AddScoped<TokenHelper>();

        //Åžimdilik Databaseloggeri destekleyemiyoruz.
        services.AddTransient<LoggerServiceBase, ElasticLogger>();
        
        JwtTokenOptions tokenOpts = new JwtTokenOptions();

        configuration.GetSection("JwtTokenOptions").Bind(tokenOpts);
        services.Configure<JwtTokenOptions>(options =>
        {
            options = tokenOpts;
        });
        services.AddSingleton<JwtTokenOptions>(sp =>
        {
            return tokenOpts;
        });

        JwtOptions jwtOpts = new JwtOptions();

        configuration.GetSection("TokenOptions").Bind(jwtOpts);
        services.Configure<JwtOptions>(options =>
        {
            options = jwtOpts;
        });
        services.AddSingleton<JwtOptions>(sp =>
        {
            return jwtOpts;
        });

        

        return services;
    }

}

