
//---------------------------------------------------------------------------------------
//      This code was generated by a Jumper tool. 
//      Runtime version : 1.0
//      Generation Time : 23.10.2023 11:28
//---------------------------------------------------------------------------------------

using Core.ApiHelpers.JwtHelper.Models;
using Core.CrossCuttingConcerns.Exceptions.Types;
using Core.CrossCuttingConcerns.Helpers.HashHelpers;
using IdentityServer.Application.Base;
using IdentityServer.Domain.Entities;

namespace IdentityServer.Application.Features.UserPasswords.Rules;

public class UserPasswordBusinessRules : BaseBusinessRules
{

    public UserPasswordBusinessRules(TokenParameters tokenParameters) : base(tokenParameters)
    {
    }

    public void ThrowExceptionIfPasswordWrong(UserPassword? password,string passwordStr)
    {
        
        if (password == null || !HashingHelper.VerifyPasswordHash(passwordStr, password.Password, password.PasswordSalt)) {
            throw new AuthorizationException("auth/login", "Lütfen Bilgilerinizi Kontrol Edin.");
        }

    }
}



